@(carrier: views.models.UserShowCarrier)(implicit messages: Messages, flash: Flash)
@import helper._

@main("ユーザー詳細") {
    @flash.get("success").map { message =>
        <div class="alert alert-success" role="alert">
            @message
        </div>
    }

    @flash.get("error").map { message =>
        <div class="alert alert-danger" role="alert">
            @message
        </div>
    }



    <div class="col-xs-6">
        @if(carrier.isMyself){
            @form(routes.FirstPartController.create) {
                <fieldset>
                    <div class="form-group">
                    @inputText(carrier.firstPartForm("firstPartContentFirst"), '_label -> "初句")
                    </div>
                    <div class="form-group">
                    @inputText(carrier.firstPartForm("firstPartContentSecond"), '_label -> "二句")
                    </div>
                    <div class="form-group">
                    @inputText(carrier.firstPartForm("firstPartContentThird"), '_label -> "三句")
                    </div>
                    <input type="hidden" name="userId" value="@carrier.requestedUser.id" />
                    <div>
                        <input type="submit" value="保存" class="btn btn-success">
                    </div>
                </fieldset>
            }
        }

        @if(!carrier.isMyself && !carrier.isFollowing) {
            @helper.form(routes.FollowingController.create(carrier.requestedUser.id.toLong)) {
                <input type="submit" value="フォロー" class="btn btn-danger btn-xs"/>
            }
        }

        @if(!carrier.isMyself && carrier.isFollowing){
            @helper.form(routes.FollowingController.delete(carrier.requestedUser.id.toLong)) {
                <input type="submit" value="フォローを解除" class="btn btn-danger btn-xs"/>
            }
        }




        <table class="table table-hover">
            <thead>
                <tr>
                    <th>初句</th>
                    <th>二句</th>
                    <th>三句</th>
                    <th>&nbsp;</th>
                    <th>&nbsp;</th>
                    <th>&nbsp;</th>
                </tr>
            </thead>
            <tbody>
                @carrier.tankas.map{ tanka  =>
                    <tr>
                        <td>@tanka._1.firstPartContentFirst</td>
                        <td>@tanka._1.firstPartContentSecond</td>
                        <td>@tanka._1.firstPartContentThird</td>
                        <td><a href="@routes.LastPartController.brandNew(tanka._1.id.toLong)">
                            <input type="submit" value="返歌" class="btn btn-danger btn-xs"/>
                        </a>
                        <td>
                        @if(carrier.currentUser.id == tanka._1.userId) {
                            <a href="@routes.FirstPartController.edit(tanka._1.id.toLong)">
                                <input type="submit" value="編集" class="btn btn-danger btn-xs"/>
                            </a>
                        }
                        </td>
                        <td>
                        @if(carrier.currentUser.id == tanka._1.userId) {
                            @helper.form(routes.FirstPartController.delete(tanka._1.id)) {
                                <input type="submit" value="削除" class="btn btn-danger btn-xs"/>
                            }
                        }
                        </td>
                    </tr>
                  @tanka._2.map{ henka =>
                      <tr>
                          <td>@henka.lastPartContentFirst</td>
                          <td>@henka.lastPartContentSecond</td>
                          <td>"後で直す"</td>
                          <td>
                          @if(carrier.currentUser.id == henka.userId) {
                              <a href="@routes.LastPartController.edit(henka.id.toLong)">
                                  <input type="submit" value="編集" class="btn btn-danger btn-xs"/>
                              </a>
                          }
                          </td>
                      <td>
                      @if(carrier.currentUser.id == henka.userId) {
                          @helper.form(routes.LastPartController.delete(henka.id.toLong)) {
                              <input type="submit" value="削除" class="btn btn-danger btn-xs"/>
                          }
                      }
                      </td>
                          <td>あとで直す</td>
                      </tr>
                  }
                }
            </tbody>
        </table>

        <table class="table table-hover">
            <thead>
                <tr>
                    <th>UserName</th>
                    @if(carrier.isMyself) {
                        <th>Email</th>
                        <th>&nbsp;</th>
                        <th>&nbsp;</th>
                    }
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>@carrier.requestedUser.username</td>
                    @if(carrier.isMyself) {
                        <td>@carrier.requestedUser.email</td>
                        <td>@helper.form(routes.UserController.edit) {
                            <input type="submit" value="編集" class="btn btn-danger btn-xs"/>
                        }
                        </td>
                        <td>@helper.form(routes.UserController.delete) {
                            <input type="submit" value="削除" class="btn btn-danger btn-xs"/>
                        }
                        </td>
                    }
                </tr>
            </tbody>
        </table>

        @if(carrier.isMyself) {
            <a href="@routes.LoginController.delete">ログアウト</a>
        }
    </div>
}

